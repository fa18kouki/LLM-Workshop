@startuml next-token-prediction
!define PRIMARY_COLOR #D92B2B
!define SECONDARY_COLOR #2D2926
!define BG_COLOR #FAFAFA

skinparam backgroundColor BG_COLOR
skinparam roundCorner 10
skinparam shadowing false

skinparam rectangle {
    BackgroundColor white
    BorderColor PRIMARY_COLOR
    FontColor SECONDARY_COLOR
}

skinparam arrow {
    Color PRIMARY_COLOR
}

rectangle "入力シーケンス(S)\n例: This is a" as input
rectangle "1. 確率計算\n(LLM Decoder)" as calc
rectangle "2. サンプリング\n(温度T, Top-k/p)" as sample
rectangle "3. シーケンス更新\n(S' = S + T)" as update

input -right-> calc
calc -right-> sample
sample -down-> update : "予測トークン(T)\n例: pen"
update -left-> input : "更新されたシーケンス(S')"

@enduml
